# Qtä¹‹setMask()
## å‰è¨€
ä½¿ç”¨é®ç½©å¯ä»¥å°†çª—å£å½¢çŠ¶å¤šæ ·åŒ–ï¼Œå˜æˆå„ç§å„æ ·çš„å›¾ç‰‡æˆ–è€…å›¾å½¢ï¼Œå…ˆçœ‹ä¸€ä¸‹æ•ˆæœå§ğŸ‘‡
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/d91d2229f3ac4b29beab07ee1575b582.gif)
å¯ä»¥çœ‹åˆ°ç°åœ¨çš„çª—å£æ˜¯ä¸€æŸèŠ±ï¼Œè€Œæˆ‘ä»¬æ‹–åŠ¨èŠ±å°±ç›¸å½“äºæ‹–åŠ¨çª—å£ï¼Œ

setMask()åªæ˜¯è¯´å¯ä»¥è®©å“ªäº›åœ°æ–¹å¯è§å“ªäº›åœ°æ–¹ä¸å¯è§å…¶å®æ–¹å½¢çª—å£ä¸€ç›´éƒ½æœ‰åœ¨ï¼Œåªæ˜¯è®©æˆ‘ä»¬åªçœ‹å¾—åˆ°èŠ±çš„éƒ¨åˆ†ï¼Œä¸‹é¢å°±æ˜¯ä¸åŠ setMask()æ—¶çš„çª—å£æ ·å­ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯æ›´æ˜ç™½äº†å‘¢ï¼ï¼
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/795ae50a93d94f5e9b544dd68df819c8.png)
æ³¨æ„ï¼šsetMaskæœ‰å‡ ç§æ–¹å¼ï¼Œå…¶ä¸­å°±æ˜¯åƒæˆ‘è¿™æ ·çš„void QWidget::setMask(const QBitmap &bitmap)ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯void QWidget::setMask(const QRegion &region)ï¼Œç¬¬äºŒç§æ˜¯æŒ‡å®šä¸€ä¸ªåŒºåŸŸå¯è§ï¼Œå¼‚æ›²åŒå·¥ï¼Œåªæ˜¯è¯´æˆ‘ä»¬æ˜¯å°†å›¾ç‰‡ä¼ è¿›å»ï¼ˆå›¾ç‰‡å¿…é¡»æ˜¯èƒŒæ™¯é€æ˜ï¼‰è®©ä¸é€æ˜çš„åœ°æ–¹å¯è§ï¼Œè€Œå¦å¤–ä¸€ç§æ–¹å¼æ˜¯æŒ‡å®šä¸€ä¸ªåŒºåŸŸï¼ˆåæ ‡åŠå¤§å°)å¯è§ã€‚

`å¦‚æœå“ªä¸ªåŒºåŸŸå¯è§ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒºåŸŸæ‰å¯ä»¥æ¥æ”¶åˆ°é¼ æ ‡ä¿¡å·å“¦!!`


---
## ä»£ç å®ç°
`widget.h`
```cpp
#ifndef WIDGET_H
#define WIDGET_H

#include <QWidget>
#include <QPoint>
#include <QMouseEvent>
QT_BEGIN_NAMESPACE
namespace Ui { class Widget; }
QT_END_NAMESPACE

class Widget : public QWidget
{
    Q_OBJECT

public:
    Widget(QWidget *parent = nullptr);
    ~Widget();
protected:
    void paintEvent(QPaintEvent *event) override;
    void mousePressEvent(QMouseEvent*event)override;
    void mouseMoveEvent(QMouseEvent*event)override;
    void mouseReleaseEvent(QMouseEvent*event)override;
private:
    Ui::Widget *ui;
    bool m_isPressed;
    QPoint  m_mousePoint;
};
#endif // WIDGET_H

```


`widget.cpp`
```cpp
#include "widget.h"
#include "ui_widget.h"
#include <QPixmap>
#include <QBitmap>
#include <QPainter>
Widget::Widget(QWidget *parent)
    : QWidget(parent)
    , ui(new Ui::Widget)
{
    ui->setupUi(this);
    QPixmap pixmap;
    pixmap.load(":/flower.png");
    resize(pixmap.size());
    //çª—å£è®¾ç½®é®ç½©
    setMask(pixmap.mask());
    m_isPressed = false;
}

Widget::~Widget()
{
    delete ui;
}

void Widget::paintEvent(QPaintEvent *event)
{
    QPainter painter(this);
    painter.drawPixmap(0,0,QPixmap(":/flower.png"));
}

void Widget::mousePressEvent(QMouseEvent *event)
{
    m_isPressed = true;
    m_mousePoint = event->globalPos()-pos();
    QWidget::mousePressEvent(event);

}

void Widget::mouseMoveEvent(QMouseEvent *event)
{
    //åªæœ‰å·¦é”®æ‰å¯ä»¥æ‹–åŠ¨
    if(m_isPressed==true&&event->buttons()&Qt::LeftButton)
    {
        move(event->globalPos()-m_mousePoint);
        m_mousePoint = event->globalPos()-pos();
        QWidget::mouseMoveEvent(event);

    }
}

void Widget::mouseReleaseEvent(QMouseEvent *event)
{
    m_isPressed = false;
    m_mousePoint = event->globalPos()-pos();
}
```

æœ€å…³é”®çš„åœ°æ–¹å°±æ˜¯å°±æ˜¯
```cpp
 QPixmap pixmap;
 pixmap.load(":/flower.png");
 resize(pixmap.size());
 //çª—å£è®¾ç½®é®ç½©
 setMask(pixmap.mask());
```
ä»¥åŠé‡ç»˜äº‹ä»¶
```cpp
void Widget::paintEvent(QPaintEvent *event)
{
    QPainter painter(this);
    painter.drawPixmap(0,0,QPixmap(":/flower.png"));
}
```